Array.prototype.filter||(Array.prototype.filter=function(t){"use strict";if(null==this)throw new TypeError;var e=Object(this),n=e.length>>>0;if("function"!=typeof t)throw new TypeError;for(var i=[],o=arguments[1],r=0;n>r;r++)if(r in e){var s=e[r];t.call(o,s,r,e)&&i.push(s)}return i}),function(t){function e(t,e){var n=t[1]-t[0],i=e[1]-e[0];return t[0]-e[0]>=0&&t[0]-e[0]<i?!0:t[0]-e[0]<=0&&t[0]+n>e[0]?!0:!1}var n={spytarget:window,scrolltopoffset:0,scrollbehavior:"smooth",scrollduration:500,highlightclass:"selected",mincontentheight:30};t.fn.ddscrollSpy=function(i){var o=t(window),r=t(window.opera?"CSS1Compat"==document.compatMode?"html":"body":"html,body");return this.each(function(){function s(e){var n=e.find('a[href^="#"]');u=[],d="",n.each(function(e){var n=t(this),i=t(n.attr("href")),o=i.get(0);if(0==i.length)return!0;n.off("click.goto").on("click.goto",function(t){if(c.spytarget!=window||"jump"!=c.scrollbehavior&&history.pushState||(window.location.hash=n.attr("href")),"smooth"==c.scrollbehavior||0!=c.scrolltopoffset){var i=c.spytarget==window?r:p,o=document.all&&!window.Worker?1:0;"smooth"!=c.scrollbehavior||!history.pushState&&c.spytarget==window?i.prop("scrollTop",u[e].offsettop+o):i.animate({scrollTop:u[e].offsettop+o},c.scrollduration,function(){c.spytarget==window&&history.pushState&&history.pushState(null,null,n.attr("href"))}),t.preventDefault()}});var s=c.spytarget==window?i.offset().top:o.offsetParent==c.spytarget?o.offsetTop:o.offsetTop-c.spytarget.offsetTop;s+=c.scrolltopoffset;var a=parseInt(i.data("spyrange"))>0?parseInt(i.data("spyrange")):i.outerHeight()||c.mincontentheight;u.push({$menuitem:n,$des:i,offsettop:s,height:a})})}function a(){1==d.length&&d.removeClass(c.highlightclass);var t=p.scrollTop(),n=p.outerHeight(),i=u.filter(function(i){return e([i.offsettop,i.offsettop+i.height],[t,t+n])});i.length>0&&(d=i.shift().$menuitem.addClass(c.highlightclass))}function l(){if(void 0!=t)var t=u[0].$menu;else var t=null;for(var e=0;e<u.length;e++){var n=u[e].$des,i=n.get(0),o=c.spytarget==window?n.offset().top:i.offsetParent==c.spytarget?i.offsetTop:i.offsetTop-c.spytarget.offsetTop;o+=c.scrolltopoffset,u[e].offsettop=o,u[e].height=parseInt(n.data("spyrange"))>0?parseInt(n.data("spyrange")):n.outerHeight()||c.mincontentheight}}var c=t.extend({},n,i),u=[],d="",p=t(c.spytarget).eq(0),f=t(this);s(f),f.on("updatespy",function(){s(f),a()}),p.on("scroll resize",function(){a()}),a(),o.on("load",function(){l()})})}}(jQuery);